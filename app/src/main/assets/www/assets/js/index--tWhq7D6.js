import{_ as e,c as a,ad as l,ae as s,af as t,ag as u,ah as n,R as c}from"./main-UPGOfi6h.js";import{c as o,I as i,J as r,K as d,L as p,O as v,u as O,N as g,F as m,P as b,x as S,R as y,U as _,Q as C,r as I,a2 as L,w as P,b as A,z as E,j as U,M as f,s as T}from"./vue-vendor-dpeM2kxB.js";import"./utils-vendor-Bv3pXXA2.js";import"./vant-vendor-CCYRvjqt.js";import"./pdfh5-DcFc6bYW.js";const k={class:"content-part"},N={class:"left-part"},Y={class:"type"},h={class:"name"},R={class:"right-part"},x={class:"right-con"},V={class:"account-size"},M={class:"label"},D={class:"expire-time"},z={class:"label"},B={class:"value"},w=e({__name:"CouponCard",props:{coupon:{type:Object,required:!0},isExpired:{type:Boolean,default:!1},isActive:{type:Boolean,default:!1},isUnselected:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:l}){const{t:s}=a(),t=e,u=l,n=()=>{t.disabled||u("click")},c=o((()=>{if(1===t.coupon.type)return"Free";return`${(100*(1-(t.coupon.discountRate||0))).toFixed(0)}% OFF`})),C=o((()=>t.coupon.applicableProduct&&"string"==typeof t.coupon.applicableProduct?t.coupon.applicableProduct.split(","):[])),I=o((()=>C.value.length>1));return(a,l)=>{const t=i("van-icon");return r(),d("div",{class:g(["coupon-card",{expired:e.isExpired,active:e.isActive,unselected:e.isUnselected,"is-disabled":e.disabled}]),onClick:n},[l[0]||(l[0]=p("img",{class:"bg-img",src:"/assets/img/bg_coupon_new-CwzhxibI.png",alt:""},null,-1)),p("div",k,[p("div",N,[p("div",Y,v(c.value),1),p("div",h,v(O(s)("MY_COUPONS.LABELS.COUPON")),1)]),p("div",R,[p("div",x,[p("div",V,[p("div",M,v(O(s)("MY_COUPONS.LABELS.ACCOUNT_SIZE")),1),p("div",{class:g(["value",{"multiple-values":I.value}])},[C.value.length>0?(r(!0),d(m,{key:0},b(C.value,((e,a)=>(r(),d("div",{key:a,class:"multiple-item"}," $"+v(e),1)))),128)):(r(),d(m,{key:1},[S("$"+v(e.coupon.accountSize),1)],64))],2)]),p("div",D,[p("div",z,v(O(s)("MY_COUPONS.LABELS.EXPIRE_TIME")),1),p("div",B,v(e.coupon.expirationTime),1)])])]),e.isActive?(r(),y(t,{key:0,name:"success",class:"check-icon"})):_("",!0)])],2)}}},[["__scopeId","data-v-d2d37a5b"]]),F={class:"coupon-con"},j={class:"coupon-description"},$={key:0,class:"invite-link"},q={class:"label"},K={class:"invite-link-url"},X={src:u,class:"copy-icon"},G={class:"coupons-list"},H={class:"coupons-footer"},J=e({__name:"index",setup(e){const u=C(),{t:g}=a(),S=[{label:g("MY_COUPONS.TABS.LOYALTY"),value:l.LOYALTY},{label:g("MY_COUPONS.TABS.VIP"),value:l.VIP}],k=I(S[0].value),N=o((()=>{switch(k.value){case l.REFERRAL:return g("MY_COUPONS.DESCRIPTION.REFERRAL");case l.LOYALTY:return g("MY_COUPONS.DESCRIPTION.LOYALTY");case l.VIP:return g("MY_COUPONS.DESCRIPTION.VIP");default:return g("MY_COUPONS.DESCRIPTION.REFERRAL")}})),Y=[{label:g("MY_COUPONS.STATUS.VALID"),value:s.VALID},{label:g("MY_COUPONS.STATUS.USED"),value:s.USED},{label:g("MY_COUPONS.STATUS.EXPIRED"),value:s.INVALID}],h=I(s.VALID),R=I(""),x=t(),{loading:V}=L(x),M=I({total:0,current:1,pageSize:10}),D=I([]),z=async()=>{const e=await x.fetchMyCoupons({page:M.value.current,limit:M.value.pageSize,state:h.value,type:k.value});M.value.total=e.dataCount,D.value=e.data};return P([()=>h.value,()=>k.value],(()=>{M.value.current=1,z()})),A((()=>{(async()=>{try{const e=await n();R.value=e.data}catch(e){}})(),z()})),(e,a)=>{const t=i("el-tab-pane"),n=i("el-tabs"),o=i("el-card"),C=i("el-radio-button"),I=i("el-radio-group"),L=i("el-empty"),P=i("el-col"),A=i("el-row"),x=i("el-pagination"),B=E("touch"),J=E("clipboard"),Q=E("el-loading");return r(),d("div",F,[U(n,{modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value=e),class:"coupon-tabs"},{default:f((()=>[(r(),d(m,null,b(S,(e=>U(t,{key:e.value,label:e.label,name:e.value},null,8,["label","name"]))),64))])),_:1},8,["modelValue"]),U(o,{style:{"margin-bottom":"20px"},class:"dark-card"},{default:f((()=>[p("div",j,v(N.value),1),k.value===O(l).REFERRAL?(r(),d("div",$,[p("div",q,v(O(g)("MY_COUPONS.LABELS.INVITE_LINK")),1),p("div",K,v(R.value),1),p("span",null,[T(p("img",X,null,512),[[B],[J,"invite-link-url"]])])])):_("",!0)])),_:1}),U(I,{modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=e=>h.value=e),class:"coupon-radio"},{default:f((()=>[(r(),d(m,null,b(Y,(e=>U(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),T((r(),d("div",G,[0===D.value.length?(r(),y(L,{key:0,"image-size":100})):(r(),y(A,{key:1,gutter:20},{default:f((()=>[(r(!0),d(m,null,b(D.value,(a=>(r(),y(P,{key:a.id,span:24,md:12,xxl:8,style:{"margin-bottom":"20px"}},{default:f((()=>[(r(),y(w,{key:e.index,coupon:a,"is-expired":h.value!==O(s).VALID,onClick:e=>(e=>{if(h.value!==s.VALID)return;let a=0;if(void 0!==e.challengeType&&null!==e.challengeType)a=e.challengeType;else switch(e.type){case l.LOYALTY:a=0;break;case l.VIP:a=1;break;default:a=0}u.push({name:c.PC.ADD_CHALLENGE,query:{couponId:e.id,challengeType:a,...e.accountSize&&{balance:e.accountSize}}})})(a)},null,8,["coupon","is-expired","onClick"]))])),_:2},1024)))),128))])),_:1})),p("div",H,[U(x,{class:"coupons-pagination",layout:"prev, pager, next",total:M.value.total,"page-size":M.value.pageSize,"current-page":M.value.current,"onUpdate:currentPage":a[2]||(a[2]=e=>M.value.current=e),onCurrentChange:z},null,8,["total","page-size","current-page"])])])),[[Q,{show:O(V),background:"rgba(0, 0, 0, 0.7)"}]])])}}},[["__scopeId","data-v-4ef865fe"]]);export{J as default};
